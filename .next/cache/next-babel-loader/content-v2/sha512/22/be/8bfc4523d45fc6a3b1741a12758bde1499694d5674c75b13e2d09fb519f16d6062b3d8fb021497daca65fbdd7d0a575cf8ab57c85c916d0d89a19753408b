{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"/home/lukatoni/Repositories/NextProjects/invoice-creator/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"/home/lukatoni/Repositories/NextProjects/invoice-creator/components/ProfileList.tsx\",\n    _s = $RefreshSig$();\n\nimport ProfileCard from '../components/ProfileCard';\nimport { supabase } from '../lib/supabaseClient';\nimport { useEffect, useReducer } from 'react';\n/**\n * Since we want this component to update in realtime,\n * we should use \"useReducer\" for sending Realtime events\n */\n\nvar handleDatabaseEvent = function handleDatabaseEvent(state, action) {\n  if (action.type === 'upsert') {\n    var otherProfiles = state.profiles.filter(function (x) {\n      return x.id != action.payload.id;\n    });\n    return {\n      profiles: [action.payload].concat(_toConsumableArray(otherProfiles))\n    };\n  } else if (action.type === 'set') {\n    return {\n      profiles: action.payload\n    };\n  }\n\n  return {\n    profiles: []\n  };\n};\n\nexport default function ProfileList(_ref) {\n  _s();\n\n  var _state$profiles,\n      _this = this;\n\n  var profiles = _ref.profiles;\n  var initialState = {\n    profiles: profiles\n  };\n\n  var _useReducer = useReducer(handleDatabaseEvent, initialState),\n      state = _useReducer[0],\n      dispatch = _useReducer[1];\n\n  useEffect(function () {\n    var subscription = supabase.from('profiles').on('*', function (payload) {\n      dispatch({\n        type: 'upsert',\n        payload: payload[\"new\"]\n      });\n    }).subscribe();\n    return function () {\n      supabase.removeSubscription(subscription);\n    };\n  }, []);\n  useEffect(function () {\n    dispatch({\n      type: 'set',\n      payload: profiles\n    });\n  }, [profiles]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: state.profiles.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"opacity-half font-light m-0\",\n      children: \"There are no public profiles created yet\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profileList\",\n      children: (_state$profiles = state.profiles) === null || _state$profiles === void 0 ? void 0 : _state$profiles.map(function (profile) {\n        return /*#__PURE__*/_jsxDEV(ProfileCard, {\n          profile: profile\n        }, profile.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n\n_s(ProfileList, \"GUSXxL/WUElrtHc/X73NyHNRMdw=\");\n\n_c = ProfileList;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProfileList\");","map":{"version":3,"sources":["/home/lukatoni/Repositories/NextProjects/invoice-creator/components/ProfileList.tsx"],"names":["ProfileCard","supabase","useEffect","useReducer","handleDatabaseEvent","state","action","type","otherProfiles","profiles","filter","x","id","payload","ProfileList","initialState","dispatch","subscription","from","on","subscribe","removeSubscription","length","map","profile"],"mappings":";;;;;;;AAAA,OAAOA,WAAP,MAAwB,2BAAxB;AAEA,SAASC,QAAT,QAAyB,uBAAzB;AACA,SAASC,SAAT,EAAoBC,UAApB,QAAsC,OAAtC;AAEA;AACA;AACA;AACA;;AAaA,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,KAAD,EAAeC,MAAf,EAAkC;AAC5D,MAAIA,MAAM,CAACC,IAAP,KAAgB,QAApB,EAA8B;AAC5B,QAAMC,aAAa,GAAGH,KAAK,CAACI,QAAN,CAAeC,MAAf,CAAsB,UAACC,CAAD;AAAA,aAAOA,CAAC,CAACC,EAAF,IAAQN,MAAM,CAACO,OAAP,CAAeD,EAA9B;AAAA,KAAtB,CAAtB;AACA,WAAO;AACLH,MAAAA,QAAQ,GAAGH,MAAM,CAACO,OAAV,4BAAsBL,aAAtB;AADH,KAAP;AAGD,GALD,MAKO,IAAIF,MAAM,CAACC,IAAP,KAAgB,KAApB,EAA2B;AAChC,WAAO;AACLE,MAAAA,QAAQ,EAAEH,MAAM,CAACO;AADZ,KAAP;AAGD;;AACD,SAAO;AAAEJ,IAAAA,QAAQ,EAAE;AAAZ,GAAP;AACD,CAZD;;AAcA,eAAe,SAASK,WAAT,OAAqD;AAAA;;AAAA;AAAA;;AAAA,MAA9BL,QAA8B,QAA9BA,QAA8B;AAClE,MAAMM,YAAmB,GAAG;AAAEN,IAAAA,QAAQ,EAARA;AAAF,GAA5B;;AADkE,oBAExCN,UAAU,CAACC,mBAAD,EAAsBW,YAAtB,CAF8B;AAAA,MAE3DV,KAF2D;AAAA,MAEpDW,QAFoD;;AAIlEd,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMe,YAAY,GAAGhB,QAAQ,CAC1BiB,IADkB,CACb,UADa,EAElBC,EAFkB,CAEf,GAFe,EAEV,UAACN,OAAD,EAAa;AACpBG,MAAAA,QAAQ,CAAC;AAAET,QAAAA,IAAI,EAAE,QAAR;AAAkBM,QAAAA,OAAO,EAAEA,OAAO;AAAlC,OAAD,CAAR;AACD,KAJkB,EAKlBO,SALkB,EAArB;AAOA,WAAO,YAAM;AACXnB,MAAAA,QAAQ,CAACoB,kBAAT,CAA4BJ,YAA5B;AACD,KAFD;AAGD,GAXQ,EAWN,EAXM,CAAT;AAaAf,EAAAA,SAAS,CAAC,YAAM;AACdc,IAAAA,QAAQ,CAAC;AAAET,MAAAA,IAAI,EAAE,KAAR;AAAeM,MAAAA,OAAO,EAAEJ;AAAxB,KAAD,CAAR;AACD,GAFQ,EAEN,CAACA,QAAD,CAFM,CAAT;AAIA,sBACE;AAAA,cACGJ,KAAK,CAACI,QAAN,CAAea,MAAf,KAA0B,CAA1B,gBACC;AAAG,MAAA,SAAS,EAAC,6BAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADD,gBAGC;AAAK,MAAA,SAAS,EAAC,aAAf;AAAA,mCACGjB,KAAK,CAACI,QADT,oDACG,gBAAgBc,GAAhB,CAAoB,UAACC,OAAD;AAAA,4BACnB,QAAC,WAAD;AAAa,UAAA,OAAO,EAAEA;AAAtB,WAAoCA,OAAO,CAACZ,EAA5C;AAAA;AAAA;AAAA;AAAA,iBADmB;AAAA,OAApB;AADH;AAAA;AAAA;AAAA;AAAA;AAJJ,mBADF;AAaD;;GAlCuBE,W;;KAAAA,W","sourcesContent":["import ProfileCard from '../components/ProfileCard'\nimport { Profile } from '../lib/constants'\nimport { supabase } from '../lib/supabaseClient'\nimport { useEffect, useReducer } from 'react'\n\n/**\n * Since we want this component to update in realtime,\n * we should use \"useReducer\" for sending Realtime events\n */\n\ntype State = {\n  profiles: Profile[]\n}\ntype Action = {\n  type?: string\n  payload: any\n}\ntype ProfileListProps = {\n  profiles: Profile[]\n}\n\nconst handleDatabaseEvent = (state: State, action: Action) => {\n  if (action.type === 'upsert') {\n    const otherProfiles = state.profiles.filter((x) => x.id != action.payload.id)\n    return {\n      profiles: [action.payload, ...otherProfiles],\n    }\n  } else if (action.type === 'set') {\n    return {\n      profiles: action.payload,\n    }\n  }\n  return { profiles: [] }\n}\n\nexport default function ProfileList({ profiles }: ProfileListProps) {\n  const initialState: State = { profiles }\n  const [state, dispatch] = useReducer(handleDatabaseEvent, initialState)\n\n  useEffect(() => {\n    const subscription = supabase\n      .from('profiles')\n      .on('*', (payload) => {\n        dispatch({ type: 'upsert', payload: payload.new })\n      })\n      .subscribe()\n\n    return () => {\n      supabase.removeSubscription(subscription)\n    }\n  }, [])\n\n  useEffect(() => {\n    dispatch({ type: 'set', payload: profiles })\n  }, [profiles])\n\n  return (\n    <>\n      {state.profiles.length === 0 ? (\n        <p className=\"opacity-half font-light m-0\">There are no public profiles created yet</p>\n      ) : (\n        <div className=\"profileList\">\n          {state.profiles?.map((profile: any) => (\n            <ProfileCard profile={profile} key={profile.id} />\n          ))}\n        </div>\n      )}\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}